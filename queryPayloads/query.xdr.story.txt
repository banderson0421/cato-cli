query xdrStory ( $perSecond:Boolean $storyId:ID $producer:StoryProducerEnum $incidentId:ID ) { xdr ( ) { story ( storyId:$storyId producer:$producer incidentId:$incidentId ) { id accountId analystName analystEmail accountName updatedAt createdAt playbook summary incident { id firstSignal lastSignal StoryEngineTypeEnumEngineType: engineType VendorEnumVendor: vendor StoryProducerEnumProducer: producer producerName ConnectionTypeEnumConnectionType: connectionType indication queryName criticality source ticket StoryStatusEnumStatus: status research siteName storyDuration description sourceIp AnalystFeedbackAnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRefSite: site { id name } UserRefUser: user { id name } StoryVerdictEnumPredictedVerdict: predictedVerdict predictedThreatType ... on MicrosoftEndpoint { MicrosoftEndpointId: id MicrosoftEndpointFirstSignal: firstSignal MicrosoftEndpointLastSignal: lastSignal MicrosoftEndpointEngineType: engineType MicrosoftEndpointVendor: vendor MicrosoftEndpointProducer: producer MicrosoftEndpointProducerName: producerName MicrosoftEndpointConnectionType: connectionType MicrosoftEndpointIndication: indication MicrosoftEndpointQueryName: queryName MicrosoftEndpointSource: source MicrosoftEndpointCriticality: criticality MicrosoftEndpointTicket: ticket MicrosoftEndpointStatus: status MicrosoftEndpointResearch: research MicrosoftEndpointSiteName: siteName MicrosoftEndpointStoryDuration: storyDuration MicrosoftEndpointDescription: description MicrosoftEndpointSourceIp: sourceIp AnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRef: site { id name } UserRef: user { id name } similarStoriesData { storyId threatTypeName verdict threatClassification similarityPercentage indication } MicrosoftEndpointPredictedVerdict: predictedVerdict MicrosoftEndpointPredictedThreatType: predictedThreatType device { id deviceName osDetails { osType osBuild osVersion } loggedOnUsers { id name ... on MicrosoftEndpointUser { MicrosoftEndpointUserId: id MicrosoftEndpointUserName: name userSid accountName domainName principalName } ... on CatoEndpointUser { CatoEndpointUserId: id CatoEndpointUserName: name } } firstSeenDateTime avStatus healthStatus rbacGroup { id name } ipInterfaces azureAdDeviceId onboardingStatus } alerts { id title description threatName MitreMitreTechnique: mitreTechnique { id name } MitreMitreSubTechnique: mitreSubTechnique { id name } createdDateTime MicrosoftEndpointResourceResources: resources { id createdDateTime RemediationStatusEnumRemediationStatus: remediationStatus remediationStatusDetails tags ResourceRoleEnumRoles: roles MsResourceVerdictEnumVerdict: verdict ... on MicrosoftProcessResource { MicrosoftProcessResourceId: id MicrosoftProcessResourceCreatedDateTime: createdDateTime MicrosoftProcessResourceRemediationStatus: remediationStatus MicrosoftProcessResourceRemediationStatusDetails: remediationStatusDetails MicrosoftProcessResourceTags: tags MicrosoftProcessResourceRoles: roles MicrosoftProcessResourceVerdict: verdict processId processCommandLine imageFile { name path size sha1 sha256 md5 issuer signer publisher } userAccount { id name ... on MicrosoftEndpointUser {  MicrosoftEndpointUserId: id  MicrosoftEndpointUserName: name  userSid  accountName  domainName  principalName } ... on CatoEndpointUser {  CatoEndpointUserId: id  CatoEndpointUserName: name } } } ... on MicrosoftFileResource { MicrosoftFileResourceId: id MicrosoftFileResourceCreatedDateTime: createdDateTime MicrosoftFileResourceRemediationStatus: remediationStatus MicrosoftFileResourceRemediationStatusDetails: remediationStatusDetails MicrosoftFileResourceTags: tags MicrosoftFileResourceRoles: roles MicrosoftFileResourceVerdict: verdict fileDetails { name path size sha1 sha256 md5 issuer signer publisher } detectionStatus } ... on MicrosoftRegistryResource { MicrosoftRegistryResourceId: id MicrosoftRegistryResourceCreatedDateTime: createdDateTime MicrosoftRegistryResourceRemediationStatus: remediationStatus MicrosoftRegistryResourceRemediationStatusDetails: remediationStatusDetails MicrosoftRegistryResourceTags: tags MicrosoftRegistryResourceRoles: roles MicrosoftRegistryResourceVerdict: verdict hive key value valueName valueType } } MicrosoftActivityActivities: activities { id resourceId parentResourceId action firstActivityDateTime lastActivityDateTime } criticality comments recommendedActions category ownerName threatFamilyName threatType resolvedDateTime firstActivityDateTime lastActivityDateTime lastUpdateDateTime localIp destinationIp destinationUrl MsAlertStatusStatus: status providerAlertId alertWebUrl AlertDeterminationEnumDetermination: determination DetectionSourceEnumDetectionSource: detectionSource AlertClassificationEnumClassification: classification } } ... on AnomalyStats { AnomalyStatsId: id AnomalyStatsFirstSignal: firstSignal AnomalyStatsLastSignal: lastSignal AnomalyStatsEngineType: engineType AnomalyStatsVendor: vendor AnomalyStatsProducer: producer AnomalyStatsProducerName: producerName AnomalyStatsConnectionType: connectionType AnomalyStatsIndication: indication AnomalyStatsQueryName: queryName AnomalyStatsSource: source AnomalyStatsCriticality: criticality AnomalyStatsTicket: ticket AnomalyStatsStatus: status AnomalyStatsResearch: research AnomalyStatsSiteName: siteName AnomalyStatsStoryDuration: storyDuration AnomalyStatsDescription: description AnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRef: site { id name } UserRef: user { id name } AnomalyStatsSourceIp: sourceIp similarStoriesData { storyId threatTypeName verdict threatClassification similarityPercentage indication } AnomalyStatsPredictedVerdict: predictedVerdict AnomalyStatsPredictedThreatType: predictedThreatType srcSiteId os deviceName macAddress logonName clientClass drillDownFilter { name value } breakdownField subjectType extra { name type value } gaussian { std ss z_score avg n } metric { name value } metricDetails { name units } mitres { id name } rules timeSeries { data ( perSecond:$perSecond ) label sum UnitTypeUnits: units info TimeseriesKeyKey: key { measureFieldName dimensions { fieldName value } } } targets { TargetTypeType: type name analysisScore infectionSource threatReference catoPopularity threatFeeds creationTime categories countryOfRegistration searchHits engines EventEventData: eventData { signatureId eventType threatType threatName severity action ruleId virusName ScanResultScanResult: scanResult appId appName dnsProtectionCategory } } direction } ... on AnomalyEvents { AnomalyEventsId: id AnomalyEventsFirstSignal: firstSignal AnomalyEventsLastSignal: lastSignal AnomalyEventsEngineType: engineType AnomalyEventsVendor: vendor AnomalyEventsProducer: producer AnomalyEventsProducerName: producerName AnomalyEventsConnectionType: connectionType AnomalyEventsIndication: indication AnomalyEventsQueryName: queryName AnomalyEventsSource: source AnomalyEventsCriticality: criticality AnomalyEventsTicket: ticket AnomalyEventsStatus: status AnomalyEventsResearch: research AnomalyEventsSiteName: siteName AnomalyEventsStoryDuration: storyDuration AnomalyEventsDescription: description AnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRef: site { id name } UserRef: user { id name } AnomalyEventsSourceIp: sourceIp similarStoriesData { storyId threatTypeName verdict threatClassification similarityPercentage indication } AnomalyEventsPredictedVerdict: predictedVerdict AnomalyEventsPredictedThreatType: predictedThreatType srcSiteId os deviceName macAddress logonName clientClass drillDownFilter { name value } breakdownField subjectType extra { name type value } gaussian { std ss z_score avg n } metric { name value } metricDetails { name units } mitres { id name } rules timeSeries { data ( perSecond:$perSecond ) label sum UnitTypeUnits: units info TimeseriesKeyKey: key { measureFieldName dimensions { fieldName value } } } targets { TargetTypeType: type name analysisScore infectionSource threatReference catoPopularity threatFeeds creationTime categories countryOfRegistration searchHits engines EventEventData: eventData { signatureId eventType threatType threatName severity action ruleId virusName ScanResultScanResult: scanResult appId appName dnsProtectionCategory } } direction } ... on Threat { ThreatId: id ThreatFirstSignal: firstSignal ThreatLastSignal: lastSignal ThreatEngineType: engineType ThreatVendor: vendor ThreatProducer: producer ThreatProducerName: producerName ThreatConnectionType: connectionType ThreatIndication: indication ThreatQueryName: queryName ThreatSource: source ThreatCriticality: criticality ThreatTicket: ticket ThreatStatus: status ThreatResearch: research ThreatSiteName: siteName ThreatStoryDuration: storyDuration ThreatDescription: description AnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRef: site { id name } UserRef: user { id name } similarStoriesData { storyId threatTypeName verdict threatClassification similarityPercentage indication } ThreatPredictedVerdict: predictedVerdict ThreatPredictedThreatType: predictedThreatType srcSiteId flowsCardinality riskLevel os deviceName macAddress ThreatSourceIp: sourceIp logonName direction clientClass events { signatureId eventType threatType threatName severity action ruleId virusName ScanResultScanResult: scanResult appId appName dnsProtectionCategory } mitres { id name } timeSeries { data ( perSecond:$perSecond ) label sum UnitTypeUnits: units info TimeseriesKeyKey: key { measureFieldName dimensions { fieldName value } } } targets { TargetTypeType: type name analysisScore infectionSource threatReference catoPopularity threatFeeds creationTime categories countryOfRegistration searchHits engines EventEventData: eventData { signatureId eventType threatType threatName severity action ruleId virusName ScanResultScanResult: scanResult appId appName dnsProtectionCategory } } flows { appName clientClass sourceIp sourcePort destinationCountry destinationIp destinationPort direction createdAt referer userAgent method url target domain sourceGeolocation destinationGeolocation tunnelGeolocation httpResponseCode dnsResponseIP smbFileName user fileHash ja3 } } ... on ThreatPrevention { ThreatPreventionId: id ThreatPreventionFirstSignal: firstSignal ThreatPreventionLastSignal: lastSignal ThreatPreventionEngineType: engineType ThreatPreventionVendor: vendor ThreatPreventionProducer: producer ThreatPreventionProducerName: producerName ThreatPreventionConnectionType: connectionType ThreatPreventionIndication: indication ThreatPreventionQueryName: queryName ThreatPreventionSource: source ThreatPreventionCriticality: criticality ThreatPreventionTicket: ticket ThreatPreventionStatus: status ThreatPreventionResearch: research ThreatPreventionSiteName: siteName ThreatPreventionStoryDuration: storyDuration ThreatPreventionDescription: description AnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRef: site { id name } UserRef: user { id name } similarStoriesData { storyId threatTypeName verdict threatClassification similarityPercentage indication } ThreatPreventionPredictedVerdict: predictedVerdict ThreatPreventionPredictedThreatType: predictedThreatType srcSiteId flowsCardinality riskLevel os deviceName macAddress ThreatPreventionSourceIp: sourceIp logonName direction clientClass events { signatureId eventType threatType threatName severity action ruleId virusName ScanResultScanResult: scanResult appId appName dnsProtectionCategory } mitres { id name } timeSeries { data ( perSecond:$perSecond ) label sum UnitTypeUnits: units info TimeseriesKeyKey: key { measureFieldName dimensions { fieldName value } } } targets { TargetTypeType: type name analysisScore infectionSource threatReference catoPopularity threatFeeds creationTime categories countryOfRegistration searchHits engines EventEventData: eventData { signatureId eventType threatType threatName severity action ruleId virusName ScanResultScanResult: scanResult appId appName dnsProtectionCategory } } threatPreventionsEvents { appName clientClass sourceIp sourcePort destinationCountry destinationIp destinationPort direction createdAt method url target domain sourceGeolocation destinationGeolocation tunnelGeolocation dnsResponseIP smbFileName user userAgent fileHash ja3 referrer httpResponseCode } } ... on NetworkXDRIncident { NetworkXDRIncidentId: id NetworkXDRIncidentFirstSignal: firstSignal NetworkXDRIncidentLastSignal: lastSignal NetworkXDRIncidentEngineType: engineType NetworkXDRIncidentVendor: vendor NetworkXDRIncidentProducer: producer NetworkXDRIncidentProducerName: producerName NetworkXDRIncidentConnectionType: connectionType NetworkXDRIncidentIndication: indication NetworkXDRIncidentQueryName: queryName NetworkXDRIncidentSource: source NetworkXDRIncidentCriticality: criticality NetworkXDRIncidentTicket: ticket NetworkXDRIncidentStatus: status NetworkXDRIncidentResearch: research NetworkXDRIncidentSiteName: siteName NetworkXDRIncidentStoryDuration: storyDuration NetworkXDRIncidentDescription: description NetworkXDRIncidentSourceIp: sourceIp AnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRef: site { id name } UserRef: user { id name } similarStoriesData { storyId threatTypeName verdict threatClassification similarityPercentage indication } NetworkXDRIncidentPredictedVerdict: predictedVerdict NetworkXDRIncidentPredictedThreatType: predictedThreatType networkIncidentTimeline { created validated description NetworkXDREventTypeEnumEventType: eventType incidentId NetworkEventSourceEnumNetworkEventSource: networkEventSource eventIds acknowledged linkId linkName LinkConfigPrecedenceEnumLinkConfigPrecedence: linkConfigPrecedence LinkStatusEnumLinkStatus: linkStatus linkConfigBandwidth DeviceConfigHaRoleEnumDeviceConfigHaRole: deviceConfigHaRole DeviceHaRoleStateEnumDeviceHaRoleState: deviceHaRoleState socketSerialId pop isp BGPConnectionBgpConnection: bgpConnection { connectionName peerIp peerAsn catoIp catoAsn } LinkQualityIssueLinkQualityIssue: linkQualityIssue { issueType direction current threshold } hostIp ruleName tunnelResetCount muted } storyType occurrences siteConnectionType siteConfigLocation acknowledged linkId linkName linkConfigPrecedence deviceConfigHaRole licenseRegion licenseBandwidth pop isp bgpConnection { connectionName peerIp peerAsn catoIp catoAsn } hostIp ruleName muted ilmmDetails { linkDetails { linkId description ispLinkId comments onboardingStatus activeLicense } ispDetails { name ispAccountId supportEmail supportPhone description countryCode loaFile { fileName fileHash uploadedAt } } contacts { name phone email } } } ... on CatoEndpoint { CatoEndpointId: id CatoEndpointFirstSignal: firstSignal CatoEndpointLastSignal: lastSignal CatoEndpointEngineType: engineType CatoEndpointVendor: vendor CatoEndpointProducer: producer CatoEndpointProducerName: producerName CatoEndpointConnectionType: connectionType CatoEndpointIndication: indication CatoEndpointQueryName: queryName CatoEndpointSource: source CatoEndpointCriticality: criticality CatoEndpointTicket: ticket CatoEndpointStatus: status CatoEndpointResearch: research CatoEndpointSiteName: siteName CatoEndpointStoryDuration: storyDuration CatoEndpointDescription: description CatoEndpointSourceIp: sourceIp AnalystFeedback: analystFeedback { verdict severity threatType { name recommendedAction details } threatClassification additionalInfo } SiteRef: site { id name } UserRef: user { id name } similarStoriesData { storyId threatTypeName verdict threatClassification similarityPercentage indication } CatoEndpointPredictedVerdict: predictedVerdict CatoEndpointPredictedThreatType: predictedThreatType device { id deviceName osDetails { osType osBuild osVersion } loggedOnUsers { id name ... on MicrosoftEndpointUser { MicrosoftEndpointUserId: id MicrosoftEndpointUserName: name userSid accountName domainName principalName } ... on CatoEndpointUser { CatoEndpointUserId: id CatoEndpointUserName: name } } macAddress } alerts { id title description threatName MitreMitreTechnique: mitreTechnique { id name } MitreMitreSubTechnique: mitreSubTechnique { id name } createdDateTime CatoResourceResources: resources { id createdDateTime RemediationStatusEnumRemediationStatus: remediationStatus ... on CatoProcessResource { CatoProcessResourceId: id CatoProcessResourceCreatedDateTime: createdDateTime CatoProcessResourceRemediationStatus: remediationStatus processId processCommandLine imageFile { name path size sha1 sha256 md5 issuer signer publisher } userAccount { id name ... on MicrosoftEndpointUser {  MicrosoftEndpointUserId: id  MicrosoftEndpointUserName: name  userSid  accountName  domainName  principalName } ... on CatoEndpointUser {  CatoEndpointUserId: id  CatoEndpointUserName: name } } } ... on CatoFileResource { CatoFileResourceId: id CatoFileResourceCreatedDateTime: createdDateTime CatoFileResourceRemediationStatus: remediationStatus fileDetails { name path size sha1 sha256 md5 issuer signer publisher } detectionStatus } } CatoActivityActivities: activities { id resourceId parentResourceId } criticality CatoEndpointEngineTypeEngineType: engineType RemediationStatusEnumStatus: status endpointProtectionProfile } } } timeline { createdAt description context TimelineTypeEnumType: type descriptions TimelineItemCategoryEnumCategory: category additionalInfo AnalystInfoAnalystInfo: analystInfo { name email } } } } }